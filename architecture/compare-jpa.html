
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta id="layout-head" />
    <title>Ebean versus JPA</title>
    <link rel="shortcut icon" href="/images/favicon.ico" >
    <!--<link href="/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/css/site.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
  <body>
  <div id="wrap">
    <div id="header">
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".mobile-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><img src="/images/logo-black-3.png" width="32" style="display: inline;">Ebean ORM</a>
        </div>
        <div class="collapse navbar-collapse">
<ul class="nav navbar-nav pull-right">
  <li ><a href="/"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li ><a href="/docs">Docs</a></li>
  <li ><a target="_blank" href="/apidocs">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li ><a target="_blank" href="https://github.com/ebean-orm/avaje-ebeanorm"> <i class="fa fa-github"></i> Github</a></li>
</ul>        </div>
        <div class="mobile-nav">
<ul class="nav navbar-nav pull-right">
  <li ><a href="/"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li ><a href="/docs">Docs</a></li>
  <li ><a target="_blank" href="/apidocs">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li ><a target="_blank" href="https://github.com/ebean-orm/avaje-ebeanorm"> <i class="fa fa-github"></i> Github</a></li>
</ul>        </div>
      </div>
    </div>

  </div>
  <div id="main" data-offset="60">
<div class="jumbotron mini">
  <div class="container">
    <h1><a href="/architecture">Architecture</a> / Compare with JPA </h1>
  </div>
</div>

<div class="container doc-index bs-docs-container">

  <div class="row">

    <div class="col-md-9" role="main">
      <h1 id="sessionless">Sessionless architecture</h1>
<p>
  JPA is architecture such that the entity beans must be <code>attached</code> to the <code>PersistenceContext</code>
  in order for the entity beans to be <code>persisted</code>.
</p>
<p>
  That is, JPA mandates <code>attach/detach</code> semantics. This has a number of consequences including:
</p>
<ul>
  <li>Developers can't easily take control and persist selected objects</li>
  <li>All attached beans must be in a valid state to flush</li>
  <li>Flush implicitly flushes all dirty state (so dirty state created <em>anywhere</em> flushes implicitly)</li>
  <li>Flush can reorder statements in unexpected ways (causing deadlocks)</li>
  <li>The EntityManager scope must now be managed along with the transaction scope</li>
</ul>

<h3>Ebean persistence</h3>

<h4>Dirty state on each bean</h4>
<p>
  For Ebean each entity bean manages it's own dirty state and do not be attached to be persisted.
</p>

<h4>JDBC batch control</h4>
<p>
  Using JDBC batch is important so that Ebean can get optimal performance when persisting. With Ebean
  there is a JDBC batch buffer attached to the transaction and can seamlessly batch up persistence
  calls using JDBC batch.
</p>
<p>
  Ebean provides full control over JDBC batch via the transaction including the
  <code>batch size</code>, <code>getGeneratedKeys</code>, and <code>cascade behavior</code>.
  Unlike JPA with Ebean it is easy to fully control and optimise batch processing.
</p>
<p>
  Ebean can match JPA persistence performance without the complexity of attach/detach semantics.
</p>


<h1 id="jpql">Query language</h1>
<blockquote>
  There were no DBA's in the room when JPQL was designed :(
</blockquote>
<p>
  <code>JPQL</code> has both poor support for <code><a href="/docs/query/partialobjects">partial objects</a></code>
  and poor support for <code><a href="/docs/query/nplus1">optimising complex queries for N + 1</a></code> by defining
  what part of the object graph should be fetched.
</p>
<p>
  In it's current state <code>JPQL</code> is a poor language for optimising ORM queries. JPA 2.1 added
  in support for <code>fetch groups</code> as a query hint but there are a number of issues with this:
  being rather inelegant to use, only a query hint with relatively poor support and ultimately missing
  some important features for controlling object graph construction from mixed sources (L2, L3 and DB).
</p>
<p>
  In JPA the emphasis on annotations <code>FetchType.Eager</code> and <code>FetchType.Lazy</code>
  and limitations in JPQL has put JPA in a bad position for optimising ORM queries and it will be
  interesting if they can get to the level of control over object graph construction that Ebean supports.
</p>
<p>
  To be absolutely clear there is absolutely no intention of supporting <code>JPQL</code>.
</p>
    </div>

    <div class="col-md-3" role="complementary">
      <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
        <ul class="nav bs-docs-sidenav">
<li class="active">
  <a href="/architecture/compare-jpa">JPA comparison</a>
<ul class="nav">
  <li><a href="#sessionless">Sessionless architecture</a></li>
  <li><a href="#jpql">Query language</a></li>
</ul>
</li>
<li >
  <a href="/architecture/compare-hibernate">Hibernate comparison</a>
</li>
<li >
  <a href="/architecture/persistence-context">Persistence context</a>
</li>

<li >
  <a href="/architecture/load-context">Load context</a>
</li>



        </ul>
      </nav>
    </div>
  </div>

</div>
  </div>
  </div>

<footer id="footer">
  <div class="doc-footer">
    <ul class="doc-footer-links">
      <li><a href="/">Ebean ORM</a></li>
      <li> | </li>
      <li><a href="http://avaje-metric.github.io">Metrics</a></li>
    </ul>
  </div>
</footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/jquery.easing.min.js"></script>

    <script src="/js/json2.js"></script>
  <script src="/js/jquery.cookie.min.js"></script>
  <script src="/js/jquery.storageapi.min.js"></script>

  <script src="/js/ebean-site.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75181644-1', 'auto');
    ga('send', 'pageview');

  </script>  </body>
</html>
