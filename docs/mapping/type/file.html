<!doctype html>
<html lang="en">
<head>
  <title>Types | Mapping | Ebean</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro|Ubuntu&display=swap">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/reset3.css">
  <link rel="stylesheet" href="/css/site3.css">
  <link rel="stylesheet" href="/css/pygments3.css">
</head>
<body>
<div id="main">
  
<div id="banner">
  <header>
    <nav id="top">
      <h1 id="breadcrumb">
        <a class="nav-logo" href="/"><img src="/images/logo-200.png" height="35"></a>&nbsp;&nbsp;<a href="/docs">Documentation</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/mapping/">Mapping</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/mapping/type">Types</a><span class="sep">&nbsp;/&nbsp;</span><span class="last">File</span>
      </h1>
      <ul>
        
        <li><a onclick="toggleTheme();" title="switch dark light theme"><i class="fas fa-adjust"></i></a></li>
      </ul>
    </nav>
  </header>
</div>
<div class="grid grid-docs">
  <aside>
<nav class="side">
  <ul>
      <li class="nav0 ">
    <a  href="/docs/getting-started">Getting started</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/intro">Introduction</a>
  </li>
  <li class="nav0 active">
    <a class="active" href="/docs">Documentation</a>
      <ul>
  <li class="nav1 ">
    <a  href="/docs/best-practice">Best practice</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/query">Query</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/persist">Persist</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/transactions">Transactions</a>
  </li>
  <li class="nav1 active">
    <a class="active" href="/docs/mapping">Mapping</a>
<ul class="nav">
    <li class="nav1 active">
    <a class="active" href="/docs/mapping/type">Types</a>
    <ul class="nav">
  <li >
    <a  href="/docs/mapping/type/enum">Enum</a>
  </li>
  <li >
    <a  href="/docs/mapping/type/uuid">UUID</a>
  </li>
  <li class="active">
    <a class="active" href="/docs/mapping/type/file">File</a>
  </li>
  <li >
    <a  href="/docs/mapping/type/boolean">Boolean</a>
  </li>
  <li >
    <a  href="/docs/mapping/type/time">Date and Time</a>
  </li>
  <li >
    <a  href="/docs/mapping/type/numeric">Numeric</a>
  </li>
  <li >
    <a  href="/docs/mapping/type#other">Other</a>
  </li>
    </ul>
  </li>

  <li class="nav1 ">
    <a  href="/docs/mapping/jpa">JPA</a>
  </li>

  <li class="nav1 ">
    <a  href="/docs/mapping/extensions">Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav1 ">
    <a  href="/docs/ddl-generation">DDL & Migrations</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/logging">Logging</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/testing">Testing</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/read-replicas">Read Replicas</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/database">Database platforms</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/multi-database">Multiple databases</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/kotlin">Kotlin</a>
  </li>
        <li><a href="/docs/tuning">Tuning</a></li>
  <li class="nav1 ">
    <a  href="/docs/features">Features</a>
  </li>
      </ul>
  </li>
  <li class="nav0 ">
    <a  href="/support">Getting help</a>
  </li>
    <li class="nav0 ">
      <a target="_blank" href="/apidoc/13">API Javadoc</a>
    </li>
  <li class="nav0 ">
    <a  href="/videos">Videos</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/upgrading">Upgrading</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/deprecated">Deprecated</a>
  </li>
  <li class="nav0 ">
    <a  href="/releases">Releases</a>
  </li>

  </ul>
</nav>
  </aside>
  <article>
<form action="https://www.google.com/search" method="get" class="inline-form">
  <input type="hidden" name="as_sitesearch" value="ebean.io">
  <div id="page-search">
    <div class="input-group">
      <input class="frm" name="q" id="searchinput" type="text" placeholder="Search... (press 's' to focus)" data-placeholder-focus="Search... (use '↑', '↓' and '⏎' to select results)" data-placeholder-blur="Search... (press 's' to focus)" autocomplete="off">
      <div class="input-group-btn">
        <button class="frm" type="submit"><i class="fas fa-search"></i></button>
      </div>
    </div>
    <div id="page-search-results" style="display: none;">
      <ul id="search-results-container" class="search-results"><li class=" active"><a href="/docs" title="Docs"><span style="color:#777;">Docs</span> Documentation </a></li><li class=""><small style="color:#999;">And 101 more...</small></li></ul>
    </div>
  </div>
</form>
    

<h2>File</h2>
<p>
  For large binary or text content (database LOB) we can model it
  in the entity bean as a property of type <code>java.io.File</code>
  and with <code>@Lob</code>.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SomeFileBean</span> <span class="o">{</span>
  <span class="o">...</span>

  <span class="nd">@Lob</span>
  <span class="n">File</span> <span class="n">content</span><span class="o">;</span>
</pre></div>
</div>
<h2>Lazy fetched by default</h2>
<p>
  By default all <code>@Lob</code> properties are fetched lazy so that means
  by default they are NOT fetched unless explicit included in the select clause.
</p>
<p>
  Note that File properties (and other Lob properties) will lazy load as needed.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">QSomeFileBean</span> <span class="n">b</span> <span class="o">=</span> <span class="n">QSomeFileBean</span><span class="o">.</span><span class="na">alias</span><span class="o">()</span>

<span class="n">SomeFileBean</span> <span class="n">bean</span> <span class="o">=</span>
  <span class="k">new</span> <span class="n">QSomeFileBean</span><span class="o">()</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">content</span><span class="o">)</span>
    <span class="o">.</span><span class="na field">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>
    <span class="o">.</span><span class="na">findOne</span><span class="o">();</span>

<span class="n">File</span> <span class="n">content</span> <span class="o">=</span> <span class="n">bean</span><span class="o">.</span><span class="na">getContent</span><span class="o">();</span>
</pre></div>
</div>

<h2>Content streamed to file</h2>
<p>
  For each File returned Ebean creates a temporary file and streams the content
  from the database Lob result into the file. As such when we fetch beans with
  Files we are expected to process the file in some way and then potentially
  discard, delete or move the temporary file. If we do not then this can result
  in a build up of temporary files in the temp directory.
</p>

<h2>Insert</h2>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// have the content as a File</span>
<span class="n">File</span> <span class="n">tempFile</span> <span class="o">=</span> <span class="o">...;</span>

<span class="n">UserProfile</span> <span class="n">profile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserProfile</span><span class="o">();</span>
<span class="n">profile</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&quot;Rob&quot;</span><span class="o">);</span>
<span class="n">profile</span><span class="o">.</span><span class="na">setProfileImage</span><span class="o">(</span><span class="n">tempFile</span><span class="o">);</span>

<span class="n">database</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">profile</span><span class="o">);</span>

<span class="c1">// typically tidy up file</span>
<span class="n">tempFile</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</pre></div>
</div>

<h2>Fetch</h2>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">QUserProfile</span> <span class="n">u</span> <span class="o">=</span> <span class="n">QUserProfile</span><span class="o">.</span><span class="na">alias</span><span class="o">()</span>

<span class="n">UserProfile</span> <span class="n">profile</span> <span class="o">=</span>
  <span class="k">new</span> <span class="n">QUserProfile</span><span class="o">()</span>
    <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">u</span><span class="o">.</span><span class="na">name</span><span class="o">,</span> <span class="n">u</span><span class="o">.</span><span class="na">profileImage</span><span class="o">)</span>
    <span class="o">.</span><span class="na field">id</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>
    <span class="o">.</span><span class="na">findOne</span><span class="o">();</span>

<span class="n">File</span> <span class="n">image</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="na">getProfileImage</span><span class="o">();</span>
<span class="c1">// do something with the image file</span>
<span class="c1">// maybe move it to a cache directory</span>
<span class="c1">// or tidy up by deleting the temporary file</span>
<span class="n">image</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</pre></div>
</div>

<h2>Stateless update</h2>
<p>
  It is often useful to perform a stateless update where we update the
  File content without fetching it.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// have the content as a File</span>
<span class="n">File</span> <span class="n">updatedProfileImage</span> <span class="o">=</span> <span class="o">...;</span>

<span class="n">UserProfile</span> <span class="n">profile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UserProfile</span><span class="o">();</span>
<span class="n">profile</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="mi">42</span><span class="o">);</span>
<span class="n">profile</span><span class="o">.</span><span class="na">setProfileImage</span><span class="o">(</span><span class="n">updatedProfileImage</span><span class="o">);</span>

<span class="c1">// perform update without fetching</span>
<span class="n">database</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">profile</span><span class="o">);</span>

<span class="c1">// typically tidy up file</span>
<span class="n">updatedProfileImage</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>
</pre></div>
</div>



  </article>
</div>

</div>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="/js/site3.js"></script>
<script src="/js/search3.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-75181644-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-75181644-1');
</script>
</body>
</html>
