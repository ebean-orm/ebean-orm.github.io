<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta id="layout-head" />
  <title>Documentation</title>
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <link rel="shortcut icon" href="/images/favicon.ico" >
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<div id="wrap">
  <div id="header">
    <div class="navbar" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".mobile-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img src="/images/lg5-21x100.png" height="35">
          </a>
        </div>
        <div class="collapse navbar-collapse">
<ul class="nav navbar-nav pull-right nav-btn-rhs">
  <li ><a href="/"><span class="fas fa-home"></span> Home</a></li>
  <li class="active"><a href="/docs">Docs</a></li>
  <li ><a href="/docs/getting-started">Get Started</a></li>
  <li ><a href="/support">Help</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a target="_blank" href="/apidoc/11">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li><a target="_blank" href="https://github.com/ebean-orm/ebean"> <i class="fab fa-github"></i></a></li>
</ul>
        </div>
        <div class="mobile-nav">
<ul class="nav navbar-nav pull-right nav-btn-rhs">
  <li ><a href="/"><span class="fas fa-home"></span> Home</a></li>
  <li class="active"><a href="/docs">Docs</a></li>
  <li ><a href="/docs/getting-started">Get Started</a></li>
  <li ><a href="/support">Help</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a target="_blank" href="/apidoc/11">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li><a target="_blank" href="https://github.com/ebean-orm/ebean"> <i class="fab fa-github"></i></a></li>
</ul>
        </div>
      </div>
    </div>

  </div>
  <div id="main">
    
<div class="jumbotron mini">
  <div class="container">
    <h1><a href="/docs/">Documentation</a> / <a href="/docs/mapping">Mapping</a> / @DbArray</h1>
  </div>
</div>

<div class="container doc-index bs-docs-container">

  <div class="row">

    <div class="col-md-9" role="main">

      <form action="https://www.google.com/search" method="get">
        <div class="page-inline-search" style="margin-bottom:8px;">
          <div class="input-group">
            <input name="q" id="searchinput" type="text" class="form-control" placeholder="Search... (press 's' to focus)" data-placeholder-focus="Search... (use '↑', '↓' and '⏎' to select results)" data-placeholder-blur="Search... (press 's' to focus)" autocomplete="off">
            <input type="hidden" name="as_sitesearch" value="ebean.io">
            <div class="input-group-btn">
              <button class="btn btn-default form-control" type="submit"><i class="glyphicon glyphicon-search"></i></button>
            </div>
          </div>
          <div class="search-results-inline-container" style="display: none;">
            <ul id="search-results-container" class="search-results"><li class=" active"><a href="/docs" title="Docs"><span style="color:#777;">Docs</span> Documentation </a></li><li class=""><small style="color:#999;">And 101 more...</small></li></ul>
          </div>
        </div>
      </form>

      



<h2 id="postgres">Postgres</h2>
<p>
  The primary target database for <code>@DbArray</code> is Postgres as single dimension array.
  In time, we could also map this to Oracle nested tables but at this stage that will be done
  on demand (you can ask and sponsor the development effort etc).
</p>

<h2 id="fallback">Fallback</h2>
<p>
  For non-Postgres the fallback is to simply store the data in JSON form in VARCHAR (ala @DbJson).
</p>

<h2>Example: uuid[]</h2>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@DbArray</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">UUID</span><span class="o">&gt;</span> <span class="n">uids</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">UUID</span><span class="o">&gt;();</span>
</pre></div>
</div>
<p>
  The example above will map to a database column type <code>uuid[]</code>.
</p>

<h2>Example: integer[]</h2>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@DbArray</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">someIds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;();</span>
</pre></div>
</div>
<p>
  The example above will map to a database column type <code>integer[]</code>.
</p>

<h2>Example: varchar[]</h2>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@DbArray</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">phoneNumbers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
</pre></div>
</div>
<p>
  The example above will map to a database column type <code>varchar[]</code>.
</p>

<h2>Fallback varchar length</h2>
<p>
  The <code>length</code> attribute is used with non-Postgres databases and defines
  the size of the varchar column used in the fallback case.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// fallback to varchar(300) for non-Postgres databases</span>
<span class="nd">@DbArray</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">300</span><span class="o">)</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">phNums</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
</pre></div>
</div>

<h2>Expressions</h2>
<p>
  Ebean "Query Beans" and ExpressionList have 4 expressions added to handle the common
  ARRAY expressions we want to execute.
</p>
<p>
  The following examples use a <code>phNums</code> property that maps to array of varchar.
</p>
<h4>contains()</h4>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Contact</span><span class="o">&gt;</span> <span class="n">contacts</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="na">find</span>
    <span class="o">.</span><span class="na">where</span><span class="o">()</span>
    <span class="o">.</span><span class="na field">phNums</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">&quot;2314&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">findList</span><span class="o">();</span>
</pre></div>
</div>
<p>
  contains() uses the <code>@></code> contains operator and
  results in the following predicate:
</p>
<div class="syntax sql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="n">t0</span><span class="p">.</span><span class="n">ph_nums</span> <span class="o">@&gt;</span> <span class="nb">array</span><span class="p">[</span><span class="o">?</span><span class="p">];</span> <span class="c1">--bind(2314)</span>
</pre></div>
</div>

<h4>notContains()</h4>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Contact</span><span class="o">&gt;</span> <span class="n">contacts</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="na">find</span>
    <span class="o">.</span><span class="na">where</span><span class="o">()</span>
    <span class="o">.</span><span class="na field">phNums</span><span class="o">.</span><span class="na">notContains</span><span class="o">(</span><span class="s">&quot;2314&quot;</span><span class="o">)</span>
    <span class="o">.</span><span class="na">findList</span><span class="o">();</span>
</pre></div>
</div>
<p>
  notContains() uses the <code>@></code> contains operator and
  results in the following predicate:
</p>
<div class="syntax sql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="k">not</span> <span class="p">(</span><span class="n">t0</span><span class="p">.</span><span class="n">ph_nums</span> <span class="o">@&gt;</span> <span class="nb">array</span><span class="p">[</span><span class="o">?</span><span class="p">]);</span> <span class="c1">--bind(2314)</span>
</pre></div>
</div>

<h4>isEmpty()</h4>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Contact</span><span class="o">&gt;</span> <span class="n">contacts</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="na">find</span>
    <span class="o">.</span><span class="na">where</span><span class="o">()</span>
    <span class="o">.</span><span class="na field">phNums</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">()</span>
    <span class="o">.</span><span class="na">findList</span><span class="o">();</span>
</pre></div>
</div>
<p>
  isEmpty() uses the cardinality function and
  results in the following predicate:
</p>
<div class="syntax sql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="n">coalesce</span><span class="p">(</span><span class="k">cardinality</span><span class="p">(</span><span class="n">t0</span><span class="p">.</span><span class="n">ph_nums</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>

<h4>isNotEmpty()</h4>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Contact</span><span class="o">&gt;</span> <span class="n">contacts</span> <span class="o">=</span> <span class="n">Contact</span><span class="o">.</span><span class="na">find</span>
    <span class="o">.</span><span class="na">where</span><span class="o">()</span>
    <span class="o">.</span><span class="na field">phNums</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">()</span>
    <span class="o">.</span><span class="na">findList</span><span class="o">();</span>
</pre></div>
</div>
<p>
  isNotEmpty() uses the cardinality function and
  results in the following predicate:
</p>
<div class="syntax sql"><div class="highlight"><pre><span></span><span class="k">where</span> <span class="n">coalesce</span><span class="p">(</span><span class="k">cardinality</span><span class="p">(</span><span class="n">t0</span><span class="p">.</span><span class="n">ph_nums</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span>
</pre></div>
</div>




    </div>

    <div class="col-md-3" role="complementary">
      <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
        <ul class="nav bs-docs-sidenav">
<li >
  <a href="/docs/mapping/dbenumvalue">@DbEnumValue</a>
</li>
<li >
  <a href="/docs/mapping/dbjson">@DbJson</a>
</li>
<li class="active">
  <a href="/docs/mapping/dbarray">@DbArray</a>
</li>
<li >
  <a href="/docs/mapping/dbhstore">@DbHstore</a>
</li>
<li >
  <a href="/docs/mapping/dbcomment">@DbComment</a>
</li>
<li >
  <a href="/docs/mapping/dbpartition">@DbPartition</a>
</li>
<li >
  <a href="/docs/mapping/when-created">@WhenCreated</a>
</li>
<li >
  <a href="/docs/mapping/when-modified">@WhenModified</a>
</li>
<li >
  <a href="/docs/mapping/who-created">@WhoCreated</a>
</li>
<li >
  <a href="/docs/mapping/who-modified">@WhoModified</a>
</li>

<li >
  <a href="/docs/mapping/soft-delete">@SoftDelete</a>
</li>
<li >
  <a href="/docs/mapping/encrypted">@Encrypted</a>
</li>
<li >
  <a href="/docs/mapping/formula">@Formula</a>
</li>
<li >
  <a href="/docs/mapping/view">@View</a>
</li>


<li >
  <a href="/docs/mapping/history">@History</a>
</li>
<li >
  <a href="/docs/mapping/change-log">@ChangeLog</a>
</li>
<li >
  <a href="/docs/mapping/read-audit">@ReadAudit</a>
</li>
        </ul>
      </nav>
    </div>
  </div>

</div>


  </div>
</div>


<footer id="footer">
  <div class="doc-footer">
    <ul class="doc-footer-links">
      <li><a href="/">Ebean ORM</a></li>
      <li> | </li>
      <li><a href="http://avaje-metric.github.io">Metrics</a></li>
    </ul>
  </div>
</footer>

  <script type="text/javascript">
    var categoryNames = {};
  </script>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/jquery.easing.min.js"></script>

    <script src="/js/jquery.storageapi.min.js"></script>
  <script src="/js/ebean-site.js"></script>
  <script src="/js/extra.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75181644-1', 'auto');
    ga('send', 'pageview');

  </script>

</body>
</html>
