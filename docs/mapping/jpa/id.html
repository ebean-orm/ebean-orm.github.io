<!doctype html>
<html lang="en">
<head>
  <title>Mapping | Ebean</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro|Ubuntu&display=swap">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/reset3.css">
  <link rel="stylesheet" href="/css/site3.css">
  <link rel="stylesheet" href="/css/pygments3.css">
</head>
<body>
<div id="main">
  
<div id="banner">
  <header>
    <nav id="top">
      <h1 id="breadcrumb">
        <a class="nav-logo" href="/"><img src="/images/logo-200.png" height="35"></a>&nbsp;&nbsp;<a href="/docs">Documentation</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/mapping/">Mapping</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/mapping/jpa/">JPA</a><span class="sep">&nbsp;/&nbsp;</span><span class="last">@Id</span>
      </h1>
      <ul>
        <li><a href="https://github.com/ebean-orm/ebean" title="github source"><i class="fab fa-github"></i></a></li>
        <li><a onclick="toggleTheme();" title="switch dark light theme"><i class="fas fa-adjust"></i></a></li>
      </ul>
    </nav>
  </header>
</div>
<div class="grid grid-docs">
  <aside>
<nav class="side">
  <ul>
      <li class="nav0 ">
    <a  href="/docs/getting-started">Getting started</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/intro">Introduction</a>
  </li>
  <li class="nav0 active">
    <a class="active" href="/docs">Documentation</a>
      <ul>
  <li class="nav1 ">
    <a  href="/docs/best-practice">Best practice</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/query">Query</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/persist">Persist</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/transactions">Transactions</a>
  </li>
  <li class="nav1 active">
    <a class="active" href="/docs/mapping">Mapping</a>
<ul class="nav">
    <li class="nav1 ">
    <a  href="/docs/mapping/type">Types</a>
  </li>

  <li class="nav1 active">
    <a class="active" href="/docs/mapping/jpa">JPA</a>
    <ul class="nav">
  <li class="active">
    <a class="active" href="/docs/mapping/jpa/id">@Id</a>
        <ul class="nav">
          <li><a href="#generated-value">Generated value</a></li>
          <li><a href="#identity">Identity</a></li>
          <li><a href="#uuid">UUID</a></li>
          <li><a href="#string">String</a></li>
          <li><a href="#no-id">No Id property</a></li>
          <li><a href="#custom">Custom Id Generator</a></li>
        </ul>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/version">@Version</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/mapped-superclass">@MappedSuperclass</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/one-to-many">@OneToMany</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/many-to-one">@ManyToOne</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/one-to-one">@OneToOne</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/many-to-many">@ManyToMany</a>
  </li>
  <li >
    <a  href="/docs/mapping/jpa/lob">@Lob</a>
  </li>
    </ul>
  </li>

  <li class="nav1 ">
    <a  href="/docs/mapping/extensions">Extensions</a>
  </li>
</ul>
  </li>
  <li class="nav1 ">
    <a  href="/docs/ddl-generation">DDL & Migrations</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/logging">Logging</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/testing">Testing</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/database">Database platforms</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/multi-database">Multiple databases</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/kotlin">Kotlin</a>
  </li>
        <li><a href="/docs/tuning">Tuning</a></li>
  <li class="nav1 ">
    <a  href="/docs/features">Features</a>
  </li>
      </ul>
  </li>
  <li class="nav0 ">
    <a  href="/support">Getting help</a>
  </li>
    <li class="nav0 ">
      <a target="_blank" href="/apidoc/13">API Javadoc</a>
    </li>
  <li class="nav0 ">
    <a  href="/videos">Videos</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/upgrading">Upgrading</a>
  </li>
  <li class="nav0 ">
    <a  href="/releases">Releases</a>
  </li>

  </ul>
</nav>
  </aside>
  <article>
<form action="https://www.google.com/search" method="get" class="inline-form">
  <input type="hidden" name="as_sitesearch" value="ebean.io">
  <div id="page-search">
    <div class="input-group">
      <input class="frm" name="q" id="searchinput" type="text" placeholder="Search... (press 's' to focus)" data-placeholder-focus="Search... (use '↑', '↓' and '⏎' to select results)" data-placeholder-blur="Search... (press 's' to focus)" autocomplete="off">
      <div class="input-group-btn">
        <button class="frm" type="submit"><i class="fas fa-search"></i></button>
      </div>
    </div>
    <div id="page-search-results" style="display: none;">
      <ul id="search-results-container" class="search-results"><li class=" active"><a href="/docs" title="Docs"><span style="color:#777;">Docs</span> Documentation </a></li><li class=""><small style="color:#999;">And 101 more...</small></li></ul>
    </div>
  </div>
</form>
    


<h2 id="id">@Id</h2>
<p>
  Mark a property as the <code>@Id</code> property.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Contact</span> <span class="o">{</span>

  <span class="nd">@Id</span>
  <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>

  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="generated-value">@GeneratedValue</h2>
<p>
  When we annotate a property with <code>@Id</code> Ebean will automatically assign an appropriate
  <code>Id generator</code> if the type <code>is a number type or UUID type</code>.
</p>
<p>
  That is, with Ebean it is effectively redundant to also add the <code>@GeneratedValue</code> annotation.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="kt">long</span> <span class="n">id</span><span class="o">;</span>

<span class="c1">// ... is effectively the same as</span>

<span class="nd">@Id</span> <span class="nd">@GeneratedValue</span>
<span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>

<h2 id="identity">@Identity</h2>
<p>
  Ebean additionally has an <a href="/docs/mapping/identity">@Identity</a> annotation
  when we want to use to specify the <code>starts value</code>, <code>cache value</code> and
  <code>generated by default|always</code> options for database identity or sequence.
</p>
<p>
  We want to use this to specifically set the <code>cache</code> option when the associated
  table is expected to get a high load of inserts and we want to let databases that support it
  to have higher than normal id caching to reduce contention around generated id values/sequences.
  Postgres, Oracle and NuoDB all support setting the identity cache option. The downside to larger
  cache for id values is the potential for larger gaps in the id values if the database is restarted.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Id</span> <span class="nd">@Identity</span><span class="o">(</span><span class="nx">start</span><span class="o">=</span><span class="mi">10000</span><span class="o">,</span> <span class="nx">cache</span><span class="o">=</span><span class="mi">500</span><span class="o">)</span>
<span class="kt">long</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>
<p>
  We can also specify <code>@Identity</code> on the class - typically when the id property
  is inherited from a MappedSuperclass.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="nd">@Identity</span><span class="o">(</span><span class="nx">start</span><span class="o">=</span><span class="mi">10000</span><span class="o">,</span> <span class="nx">cache</span><span class="o">=</span><span class="mi">500</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Contact</span> <span class="o">{</span>

  <span class="nd">@Id</span>
  <span class="kt">long</span> <span class="n">id</span><span class="o">;</span>

  <span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="uuid">UUID</h2>
<p>
  If the @Id type is <code>UUID</code> then Ebean will automatically assign an appropriate Id generator
  to that property.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// an appropriate UUID based Id generator</span>
<span class="c1">// is automatically assigned</span>
<span class="nd">@Id</span>
<span class="n">UUID</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>

<h2 id="string">String</h2>
<p>
  If the @Id type is <code>String</code> then Ebean assumes that the id value is supplied by the
  application. No Id generator is assigned to the Id property in this case.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Id</span>
<span class="n">String</span> <span class="n">code</span><span class="o">;</span>
</pre></div>
</div>
<p>
  An example of this could be ISO Country codes used as a primary key for Country.
</p>

<h2 id="no-id">Entities with no @Id property</h2>
<p>
  We can model entity beans without any <code>@Id</code> property. The 2 cases for this are
  when modelling views and when modelling tables that are "insert only" representing a log
  of events or similar.
</p>
<h3>Views</h3>
<p>
  When the entity bean is modelled to a <code>@View</code> often the view will not have
  column(s) that equates to a primary key.
</p>
<h5>Example - entity based on a view with @Id property</h5>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Entity</span>
<span class="nd">@View</span><span class="o">(</span><span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;machine_stats&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MachineStats</span> <span class="o">{</span>

  <span class="nd">@ManyToOne</span>
  <span class="n">Machine</span> <span class="n">machine</span><span class="o">;</span>

  <span class="n">LocalDate</span> <span class="n">date</span><span class="o">;</span>

  <span class="nd">@Sum</span>  <span class="c1">// equivalent to @Aggregation(&quot;sum(totalKms)&quot;)</span>
  <span class="kt">long</span> <span class="n">totalKms</span><span class="o">;</span>

  <span class="nd">@Sum</span>
  <span class="kt">long</span> <span class="n">hours</span><span class="o">;</span>

  <span class="nd">@Max</span>
  <span class="n">BigDecimal</span> <span class="n">rate</span><span class="o">;</span>

  <span class="nd">@Aggregation</span><span class="o">(</span><span class="s">&quot;sum(cost)&quot;</span><span class="o">)</span>
  <span class="n">BigDecimal</span> <span class="n">totalCost</span><span class="o">;</span>

  <span class="nd">@Aggregation</span><span class="o">(</span><span class="s">&quot;max(totalKms)&quot;</span><span class="o">)</span>
  <span class="n">BigDecimal</span> <span class="n">maxKms</span><span class="o">;</span>
</pre></div>
</div>
<h3>Tables with no primary key</h3>
<p>
  When modelling a "append only" table where we do not <em>need</em> a primary key
  then we can desire not having an <code>@Id</code> property and no actual primary key.
  We can desire this when we want to avoid the cost of the primary key index (that the
  application will never need or use).
</p>
<p>
  For Postgres we would often use table partitioning for this type of "append only" events
  type table via <code>@DbPartition</code>.
</p>

<h5>Example - append only table with no primary key / no @Id property</h5>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * Append only table with no Id property, no primary key (no primary key index).</span>
<span class="cm"> */</span>
<span class="nd">@DbPartition</span><span class="o">(</span><span class="nx">mode</span> <span class="o">=</span> <span class="nx">DAY</span><span class="o">,</span> <span class="nx">property</span> <span class="o">=</span> <span class="s">&quot;eventTime&quot;</span><span class="o">)</span>
<span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="nx">name</span> <span class="o">=</span> <span class="s">&quot;machine_log&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MachineLog</span> <span class="o">{</span>

  <span class="nd">@Index</span>
  <span class="nd">@NotNull</span>
  <span class="kd">protected</span> <span class="n">Instant</span> <span class="n">eventTime</span><span class="o">;</span>

  <span class="nd">@DbForeignKey</span><span class="o">(</span><span class="nx">noConstraint</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
  <span class="nd">@ManyToOne</span><span class="o">(</span><span class="nx">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span>
  <span class="kd">protected</span> <span class="n">Machine</span> <span class="n">machine</span><span class="o">;</span>

  <span class="o">...</span>
</pre></div>
</div>

<h2 id="custom">Custom Id Generator</h2>
<p>
  There is support for registering and using a custom Id generator.
</p>

<h4>1. Implement io.ebean.config.IdGenerator</h4>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModUuidGenerator</span> <span class="kd">implements</span> <span class="n">IdGenerator</span> <span class="o">{</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">nextValue</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">ModUUID</span><span class="o">.</span><span class="na">newShortId</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;shortUid&quot;</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<h4>2. Register with ServerConfig</h4>
<p>
  We register the IdGenerator with ServerConfig by using <code>addClass()</code>
  or <code>add(IdGenerator idGenerator)</code> or <code>setIdGenerators(List<IdGenerator> idGenerators)</code>.
</p>
<p>
  Note that if you are using classpath scanning to find entity beans that this will also automatically
  find implementations of IdGenerator and automatically register them so in this case you don't need to
  register the IdGenerator manually with ServerConfig.
</p>

<h4>3. @GeneratedValue</h4>
<p>
  We can then tell Ebean to use our custom IdGenerator by using the <code>@GeneratedValue</code> with
  the generator being the name of our custom IdGenerator.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="nd">@Id</span> <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="nx">generator</span> <span class="o">=</span> <span class="s">&quot;shortUid&quot;</span><span class="o">)</span>
<span class="n">String</span> <span class="n">id</span><span class="o">;</span>
</pre></div>
</div>

<h2 id="no-lazy-loading">No lazy loading</h2>
<p>
  Note that <code>@Id</code> properties never invoke lazy loading.
</p>

<h2 id="database-platform">Database platform</h2>
<p>
  All the supported databases use either <code>Identity</code> or <code>Sequences</code> (or allow both)
  and Ebean will choose the appropriate Id generation strategy based on the database platform.
</p>
<table class="table">
  <tr><th>Database</th><th>Strategy</th></tr>
  <tr><td>H2</td><td>Identity (also supports sequences)</td></tr>
  <tr><td>Postgres</td><td>Identity (as serial, also supports sequences)</td></tr>
  <tr><td>MySql</td><td>Identity</td></tr>
  <tr><td>Oracle</td><td>Sequences (also supports Identity)</td></tr>
  <tr><td>DB2</td><td>Identity (also supports sequences)</td></tr>
  <tr><td>SQL Server</td><td>Identity</td></tr>
  <tr><td>SQLite</td><td>Identity</td></tr>
  <tr><td>SqlAnywhere</td><td>Identity</td></tr>
</table>

  <nav class="next">
    <p class="edit-page">
      <a href="https://github.com/ebean-orm/website-source/blob/master/docs/mapping/jpa/id.html"><i class="fab fa-github"></i> Edit Page</a>
    </p>
    <p class="next">
      <a href="version" class="btn btn-info">Next: Version</a>
    </p>
  </nav>



  </article>
</div>

</div>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="/js/site3.js"></script>
<script src="/js/search3.js"></script>
</body>
</html>
