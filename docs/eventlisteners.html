
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta id="layout-head" />
    <title>avaje ebean</title>
    <link rel="shortcut icon" href="/images/favicon.ico" >
    <!--<link href="/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/css/site.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
  <body>
  <div id="wrap">
    <div id="header">
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Ebean ORM</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav pull-right">
            <li ><a href="/"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
            <li ><a href="/videos">Videos</a></li>
            <li ><a href="/quickstart">Quick Start</a></li>
            <li ><a href="/support">Support</a></li>
            <li class="active"><a href="/docs">Docs</a></li>
            <li ><a target="_blank" href="/apidocs">ApiDocs</a></li>
            <li ><a href="/releases">Releases</a></li>
            <li ><a target="_blank" href="https://github.com/ebean-orm/avaje-ebeanorm"> <i class="fa fa-github"></i> Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

  </div>
  <div id="main" data-offset="60">
<div class="jumbotron mini">
  <div class="container">
    <h1><a href="/docs">Documentation</a> / Event listeners </h1>
  </div>
</div>

<div class="container doc-index bs-docs-container">

  <div class="row">

    <div class="col-md-9" role="main">

      <div class="bs-docs-section">
<h1 id="event_listeners">Event listeners</h1>
...(under construction)...

<p>Since version 4.0.1, Ebean supports JPA EntityListener Annotations:
  <ul>
    <li>@PostLoad</li>
    <li>@PostPersist</li>
    <li>@PostRemove</li>
    <li>@PostUpdate</li>
    <li>@PrePersist</li>
    <li>@PreRemove</li>
    <li>@PreUpdate</li>
  </ul>

<div class="syntax java"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">javax.persistence.PostLoad</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostPersist</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostRemove</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostUpdate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PrePersist</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PreRemove</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PreUpdate</span><span class="o">;</span>

<span class="o">...</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>

  <span class="nd">@Id</span>
  <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>

  <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="nd">@Version</span>
  <span class="n">Long</span> <span class="n">version</span><span class="o">;</span>


  <span class="nd">@PrePersist</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">prePersist1</span><span class="o">()</span> <span class="o">{</span>
      <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PostPersist</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postPersist1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PreUpdate</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">preUpdate1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostUpdate</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postUpdate1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PreRemove</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">preRemove1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostRemove</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postRemove1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostLoad</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postLoad1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>
</pre></div>
</div>

<h4>BeanPersistController</h4>
<p>To listen for events on entity, you can also use the BeanPersistController</p>

<p>BeanPersistController is used to enhance or override the default bean persistence mechanism.</p>

<p>Note that if want to totally change the finding, you need to use a BeanQueryAdapter rather than using postLoad().</p>

<p>Note that getTransaction() on the PersistRequest returns the transaction used for the insert, update, delete or fetch. To explicitly use this same transaction you should use this transaction via methods on EbeanServer.</p>

<div class="syntax java"><div class="highlight"><pre><span class="n">Object</span> <span class="n">extaBeanToSave</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">Transaction</span> <span class="n">t</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="n">EbeanServer</span> <span class="n">server</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getEbeanServer</span><span class="o">();</span>
<span class="n">server</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">extraBeanToSave</span><span class="o">,</span> <span class="n">t</span><span class="o">);</span>
</pre></div>
</div>

<p>It is worth noting that BeanPersistListener is different in three main ways from BeanPersistController postXXX methods.</p>

<p>BeanPersistListener only sees successfully committed events. BeanController pre and post methods occur before the commit or a rollback and will see events that are later rolled back</p>

<p>BeanPersistListener runs in a background thread and will not effect the response time of the actual persist where as BeanController code will
BeanPersistListener can be notified of events from other servers in a cluster.</p>

<p>A BeanPersistController is either found automatically via class path search or can be added programmatically via ServerConfiguration.addEntity().</p>



</div>

    </div>

    <div class="col-md-3" role="complementary">
      <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
        <ul class="nav bs-docs-sidenav">

<li >
  <a href="/docs/introduction">Introduction</a>
</li>
<li >
  <a href="/docs/enhancement">Enhancement</a>
</li>
<li >
  <a href="/docs/serverconfig">ServerConfig</a>
</li>
<li >
  <a href="/docs/guice">Guice</a>
</li>
<li >
  <a href="/docs/spring">Spring</a>
</li>
<li >
  <a href="/docs/activerecord">Active Record</a>
</li>
<li >
  <a href="/docs/queries">Queries</a>
</li>
<li >
  <a href="/docs/saving">Saving</a>
</li>
<li >
  <a href="/docs/mapping">Mapping</a>
</li>
<li >
  <a href="/docs/transactions">Transactions</a>
</li>
<li >
  <a href="/docs/json">JSON</a>
</li>
<li class="active">
  <a href="/docs/eventlisteners">Event listeners</a>
</li>
<li >
  <a href="/docs/readaudit">Read Audit</a>
</li>
<li >
  <a href="/docs/changelog">Change Log</a>
</li>
<li >
  <a href="/docs/l2caching">L2 caching</a>
</li>
<li >
  <a href="/docs/testing">Testing</a>
</li>
<li >
  <a href="/docs/jvmlanguages">JVM Languages</a>
</li>

<li >
  <a href="/docs/clustering">Clustering</a>
</li>
<li >
  <a href="/docs/monitoring">Monitoring</a>
</li>
<li >
  <a href="/docs/architecture">Architecture</a>
</li>
        </ul>
      </nav>
    </div>
  </div>

</div>
<!-- /.row -->
</div>  <!-- /.container -->
  </div>
</div>

<footer id="footer">
 <div class="doc-footer">
  <ul class="doc-footer-links">
    <li><a href="/">Ebean ORM</a></li>
    <li> | </li>
    <li><a href="http://avaje-metric.github.io">Metrics</a></li>
    <li> | </li>
    <li><a href="/websitegenerator/index">Website Generator</a></li>
    <li> | </li>
    <li><a href="/jetty/index">Jetty Runnable War</a></li>
  </ul>
 </div>
</footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/jquery.easing.min.js"></script>

  <script src="/js/json2.js"></script>
  <script src="/js/jquery.cookie.min.js"></script>
  <script src="/js/jquery.storageapi.min.js"></script>

  <script src="/js/ebean-site.js"></script>

  </body>
</html>
