<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta id="layout-head" />
  <title>Features</title>
  <link rel="shortcut icon" href="/images/favicon.ico" >
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<div id="wrap">
  <div id="header">
    <div class="navbar" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".mobile-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <img src="/images/lg5-21x100.png" height="35">
          </a>
        </div>
        <div class="collapse navbar-collapse">
<ul class="nav navbar-nav pull-right nav-btn-rhs">
  <li ><a href="/"><span class="fas fa-home"></span> Home</a></li>
  <li ><a href="/docs">Docs</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li ><a target="_blank" href="/apidoc/11">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li><a target="_blank" href="https://github.com/ebean-orm/ebean"> <i class="fab fa-github"></i></a></li>
</ul>
        </div>
        <div class="mobile-nav">
<ul class="nav navbar-nav pull-right nav-btn-rhs">
  <li ><a href="/"><span class="fas fa-home"></span> Home</a></li>
  <li ><a href="/docs">Docs</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li ><a target="_blank" href="/apidoc/11">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li><a target="_blank" href="https://github.com/ebean-orm/ebean"> <i class="fab fa-github"></i></a></li>
</ul>
        </div>
      </div>
    </div>

  </div>
  <div id="main">
    
<div class="jumbotron mini">
  <div class="container">
    <h1><a href="/docs/">Documentation</a> / <a href="/docs/features/">Features</a> / Event listening</h1>
  </div>
</div>

<div class="container doc-index bs-docs-container">

  <div class="row">

    <div class="col-md-9" role="main">

      <form action="https://www.google.com/search" method="get">
        <div class="page-inline-search" style="margin-bottom:8px;">
          <div class="input-group">
            <input name="q" id="searchinput" type="text" class="form-control" placeholder="Search... (press 's' to focus)" data-placeholder-focus="Search... (use '↑', '↓' and '⏎' to select results)" data-placeholder-blur="Search... (press 's' to focus)" autocomplete="off">
            <input type="hidden" name="as_sitesearch" value="ebean-orm.github.io">
            <div class="input-group-btn">
              <button class="btn btn-default form-control" type="submit"><i class="glyphicon glyphicon-search"></i></button>
            </div>
          </div>
          <div class="search-results-inline-container" style="display: none;">
            <ul id="search-results-container" class="search-results"><li class=" active"><a href="/docs" title="Docs"><span style="color:#777;">Docs</span> Documentation </a></li><li class=""><small style="color:#999;">And 101 more...</small></li></ul>
          </div>
        </div>
      </form>

      

<div class="bs-docs-section">
<h1 id="event_listeners">Event listening</h1>
...(under construction)...

<p>Since version 4.0.1, Ebean supports JPA EntityListener Annotations:
  <ul>
    <li>@PostLoad</li>
    <li>@PostPersist</li>
    <li>@PostRemove</li>
    <li>@PostUpdate</li>
    <li>@PrePersist</li>
    <li>@PreRemove</li>
    <li>@PreUpdate</li>
  </ul>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">javax.persistence.PostLoad</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostPersist</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostRemove</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PostUpdate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PrePersist</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PreRemove</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.persistence.PreUpdate</span><span class="o">;</span>

<span class="o">...</span>

<span class="nd">@Entity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Customer</span> <span class="o">{</span>

  <span class="nd">@Id</span>
  <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>

  <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

  <span class="nd">@Version</span>
  <span class="n">Long</span> <span class="n">version</span><span class="o">;</span>


  <span class="nd">@PrePersist</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">prePersist1</span><span class="o">()</span> <span class="o">{</span>
      <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PostPersist</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postPersist1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PreUpdate</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">preUpdate1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostUpdate</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postUpdate1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>


  <span class="nd">@PreRemove</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">preRemove1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostRemove</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postRemove1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>

  <span class="nd">@PostLoad</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postLoad1</span><span class="o">()</span> <span class="o">{</span>
    <span class="o">...</span>
  <span class="o">}</span>
</pre></div>
</div>

<h4>BeanPersistController</h4>
<p>To listen for events on entity, you can also use the BeanPersistController</p>

<p>BeanPersistController is used to enhance or override the default bean persistence mechanism.</p>

<p>Note that if want to totally change the finding, you need to use a BeanQueryAdapter rather than using postLoad().</p>

<p>Note that getTransaction() on the PersistRequest returns the transaction used for the insert, update, delete or fetch. To explicitly use this same transaction you should use this transaction via methods on EbeanServer.</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">Object</span> <span class="n">extaBeanToSave</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">Transaction</span> <span class="n">t</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getTransaction</span><span class="o">();</span>
<span class="n">EbeanServer</span> <span class="n">server</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getEbeanServer</span><span class="o">();</span>
<span class="n">server</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">extraBeanToSave</span><span class="o">,</span> <span class="n">t</span><span class="o">);</span>
</pre></div>
</div>

<p>It is worth noting that BeanPersistListener is different in three main ways from BeanPersistController postXXX methods.</p>

<p>BeanPersistListener only sees successfully committed events. BeanController pre and post methods occur before the commit or a rollback and will see events that are later rolled back</p>

<p>BeanPersistListener runs in a background thread and will not effect the response time of the actual persist where as BeanController code will
BeanPersistListener can be notified of events from other servers in a cluster.</p>

<p>A BeanPersistController is either found automatically via class path search or can be added programmatically via ServerConfiguration.addEntity().</p>



</div>


    </div>

    <div class="col-md-3" role="complementary">
      <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
        <ul class="nav bs-docs-sidenav">
<li >
  <a href="/docs/features/elasticsearch">ElasticSearch</a>
</li>

<li >
  <a href="/docs/features/history">History SQL2011</a>
</li>

<li >
  <a href="/docs/features/json-in-db">JSON in DB</a>
</li>

<li >
  <a href="/docs/features/json">JSON</a>
</li>
<li class="active">
  <a href="/docs/features/eventlistening">Event listening</a>
</li>

<li >
  <a href="/docs/features/softdelete">Soft Delete</a>
</li>

<li >
  <a href="/docs/features/who">Who Created Modified</a>
</li>

<li >
  <a href="/docs/features/readauditing">Read Auditing</a>
</li>
<li >
  <a href="/docs/features/changelog">Change Log</a>
</li>
<li >
  <a href="/docs/features/draftable">Draftable</a>
</li>
<li >
  <a href="/docs/features/l2caching">L2 caching</a>
</li>

<li >
  <a href="/docs/features/jvmlanguages">JVM Languages</a>
</li>

<li >
  <a href="/docs/features/monitoring">Monitoring</a>
</li>
<li >
  <a href="/docs/setup/dbmigration">DB Migration</a>
</li>
        </ul>
      </nav>
    </div>
  </div>

</div>


  </div>
</div>


<footer id="footer">
  <div class="doc-footer">
    <ul class="doc-footer-links">
      <li><a href="/">Ebean ORM</a></li>
      <li> | </li>
      <li><a href="http://avaje-metric.github.io">Metrics</a></li>
    </ul>
  </div>
</footer>

  <script type="text/javascript">
    var categoryNames = {};
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/jquery.easing.min.js"></script>

    <script src="/js/jquery.storageapi.min.js"></script>
  <script src="/js/ebean-site.js"></script>
  <script src="/js/extra.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75181644-1', 'auto');
    ga('send', 'pageview');

  </script>

</body>
</html>
