<!doctype html>
<html lang="en">
<head>
  <title>L2 Cache | Ebean ORM</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro|Ubuntu&display=swap">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/reset3.css">
  <link rel="stylesheet" href="/css/site3.css">
  <link rel="stylesheet" href="/css/pygments3.css">
</head>
<body>
<div id="main">
  
<div id="banner">
  <header>
    <nav id="top">
      <h1 id="breadcrumb">
        <a class="nav-logo" href="/"><img src="/images/logo-200.png" height="35"></a>&nbsp;&nbsp;<a href="/docs">Documentation</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/features/">Features</a><span class="sep">&nbsp;/&nbsp;</span><a href="/docs/features/l2cache/">L2 Cache</a><span class="sep">&nbsp;/&nbsp;</span><span class="last">Apache Ignite</span>
      </h1>
      <ul>
        <li><a href="https://github.com/ebean-orm/ebean" title="github source"><i class="fab fa-github"></i></a></li>
        <li><a onclick="toggleTheme();" title="switch dark light theme"><i class="fas fa-adjust"></i></a></li>
      </ul>
    </nav>
  </header>
</div>
<div class="grid grid-docs">
  <aside>
<nav class="side">
  <ul>
      <li class="nav0 ">
    <a  href="/docs/getting-started">Getting started</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/intro">Introduction</a>
  </li>
  <li class="nav0 active">
    <a class="active" href="/docs">Documentation</a>
      <ul>
  <li class="nav1 ">
    <a  href="/docs/best-practice">Best practice</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/query">Query</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/persist">Persist</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/transactions">Transactions</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/mapping">Mapping</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/ddl-generation">DDL & Migrations</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/logging">Logging</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/testing">Testing</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/database">Database platforms</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/multi-database">Multiple databases</a>
  </li>
  <li class="nav1 ">
    <a  href="/docs/kotlin">Kotlin</a>
  </li>
        <li><a href="/docs/tuning">Tuning</a></li>
  <li class="nav1 active">
    <a class="active" href="/docs/features">Features</a>
<ul class="nav">
    <li class="active">
    <a class="active" href="/docs/features/l2cache">L2 Cache</a>
  <ul class="nav">

  <li >
    <a  href="/docs/features/l2cache">Overview</a>
  </li>

  <li >
    <a  href="/docs/features/l2cache/bean-cache">Bean caching</a>
  </li>
  <li >
    <a  href="/docs/features/l2cache/query-cache">Query caching</a>
  </li>
  <li >
    <a  href="/docs/features/l2cache/hazelcast">Hazelcast</a>
  </li>
  <li class="active">
    <a class="active" href="/docs/features/l2cache/apache-ignite">Apache Ignite</a>
<ul class="nav nav-scroll">
  <li><a href="#client-server">Client/server mode</a></li>
  <li><a href="#server-mode">Server mode</a></li>
  <li><a href="#dependency">Dependency</a></li>
  <li><a href="#disable">Disable L2 cache</a></li>
  <li><a href="#configuration">Configuration</a></li>
  <li><a href="#getting-started">Getting started</a></li>
</ul>
  </li>
  </ul>
  </li>
  <li >
    <a  href="/docs/features/elasticsearch">Elasticsearch</a>
  </li>

  <li >
    <a  href="/docs/features/json-in-db">@DbJson</a>
  </li>
  <li >
    <a  href="/docs/features/softdelete">Soft Delete</a>
  </li>
  <li >
    <a  href="/docs/features/encryption">Encryption</a>
  </li>

  <li >
    <a  href="/docs/features/who">@WhoModified / @WhoCreated</a>
  </li>

  <li >
    <a  href="/docs/features/history">SQL2011 History</a>
  </li>
  <li >
    <a  href="/docs/features/changelog">ChangeLog</a>
  </li>
  <li >
    <a  href="/docs/features/readauditing">Read auditing</a>
  </li>
  <li >
    <a  href="/docs/features/eventlistening">Event Listening</a>
  </li>

</ul>
  </li>
      </ul>
  </li>
  <li class="nav0 ">
    <a  href="/support">Getting help</a>
  </li>
    <li class="nav0 ">
      <a target="_blank" href="/apidoc/13">API Javadoc</a>
    </li>
  <li class="nav0 ">
    <a  href="/videos">Videos</a>
  </li>
  <li class="nav0 ">
    <a  href="/docs/upgrading">Upgrading</a>
  </li>
  <li class="nav0 ">
    <a  href="/releases">Releases</a>
  </li>

  </ul>
</nav>
  </aside>
  <article>
<form action="https://www.google.com/search" method="get" class="inline-form">
  <input type="hidden" name="as_sitesearch" value="ebean.io">
  <div id="page-search">
    <div class="input-group">
      <input class="frm" name="q" id="searchinput" type="text" placeholder="Search... (press 's' to focus)" data-placeholder-focus="Search... (use '↑', '↓' and '⏎' to select results)" data-placeholder-blur="Search... (press 's' to focus)" autocomplete="off">
      <div class="input-group-btn">
        <button class="frm" type="submit"><i class="fas fa-search"></i></button>
      </div>
    </div>
    <div id="page-search-results" style="display: none;">
      <ul id="search-results-container" class="search-results"><li class=" active"><a href="/docs" title="Docs"><span style="color:#777;">Docs</span> Documentation </a></li><li class=""><small style="color:#999;">And 101 more...</small></li></ul>
    </div>
  </div>
</form>
    

<h2>Apache Ignite</h2>
<p>
  <a href="https://ignite.apache.org/">Apache Ignite</a> provides a very nice set of features for
  distributed caching (which is what we use it for with L2 caching) plus "Data grid" features.
</p>
<p>
  My expectation is that most people will prefer client/server mode with use of near caches.
</p>

<h3 id="client-server">Client/server mode</h3>
<p>
  We can use Ignite in <code>client/server</code> mode which means that our application uses a
  <code>Ignite client</code> to talk to a Ignite cluster (of servers).
</p>
<p>
  In this mode the bean cache data is partitioned across all the Ignite servers in the cluster
  and not in our application. We can choose to use a <code>near cache</code> for some or all of our bean
  types and in doing so improve performance (by having local data) but increase memory footprint in our
  application (as it now holds some cache data).
</p>

<h3 id="server-mode">Server mode</h3>
<p>
  In server mode our application starts a <code>Ignite server instance</code> which is a full fledged member
  of the Ignite cluster. This means that it will hold data etc.
</p>


<h3 id="dependency">Dependency</h3>
<p>
  Add a dependency to <code>ebean-ignite</code>. Pre-built packages are located on
  <a href="https://mvnrepository.com/artifact/io.ebean/ebean-ignite">maven</a>. The version of the <code>ebean-ignite</code>
  artifact you seleect should match the version of ebean that you are using.

  When Ebean starts, ebean-ignite is automatically registered as the L2 cache implementation.
</p>

<h3 id="disable">Disable L2 cache</h3>
<p>
  During development and testing it is often useful to disable the use of the l2 cache.
</p>

<h5>Properties</h5>
<div class="syntax properties"><div class="highlight"><pre><span></span><span class="c">## disable use of L2 cache (for dev / testing etc)</span>
<span class="na">ebean.disableL2Cache</span><span class="o">=</span><span class="s">true</span>
</pre></div>
</div>
<p>

</p>

<h3 id="configuration">Configuration</h3>
<p>
  Apache Ignite is configured with a <code>IgniteConfiguration</code> class. The documentation for this class
  is available <a href="https://ignite.apache.org/releases/latest/javadoc/org/apache/ignite/configuration/IgniteConfiguration.html">here</a>.
  This class can be delivered in two ways: with an XML configuration file (which represents a persisted version of this bean),
  and programmatically by constructing this class and passing it into the <code>Igniter</code>.
</p>
<p>For more information about Ignite Configuration, start <a href="https://ignite.apache.org/docs/latest/understanding-configuration">here</a>.</p>


<h4>XML configuration</h4>
<p>To configure the Ignite instance via XML, you need to construct an XML file that represents the IgniteConfiguration
  bean in a persisted state. Then you must place this file in a location that Ignite expects.</p>  According to the documentation,
when Ignite starts it looks for a configuration file in <code>{IGNITE_HOME}/config/default-config.xml</code>. You should be
able to export the IGNITE_HOME environment variable to point to a director that contains your configuration file.
</p>

<h4>Programmatic configuration</h4>
<p>
  You can programmatically configure Ignite by creating an instance of <code>IgniteConfiguration</code>
  and setting it via: <code></code>
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">IgniteConfiguration</span> <span class="n">configuration</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">serverConfig</span><span class="o">.</span><span class="na">setServiceObject</span><span class="o">(</span><span class="s">&quot;igniteConfiguration&quot;</span><span class="o">,</span> <span class="n">configuration</span><span class="o">);</span>
</pre></div>
</div>
<p>To do this automatically at startup, you can create a class that implements <code>ServerConfigStartup</code> and place it
  in the directory where you tell ebean to look for your models.</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nn">models</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">io.ebean.config.ServerConfig</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.ebean.event.ServerConfigStartup</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ignite.configuration.IgniteConfiguration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ignite.spi.discovery.tcp.TcpDiscoverySpi</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ignite.spi.discovery.tcp.ipfinder.vm.TcpDiscoveryVmIpFinder</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyServerConfigStartup</span> <span class="kd">implements</span> <span class="n">ServerConfigStartup</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStart</span><span class="o">(</span><span class="n">ServerConfig</span> <span class="n">serverConfig</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">IgniteConfiguration</span> <span class="n">igniteCfg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IgniteConfiguration</span><span class="o">();</span>
        <span class="n">igniteCfg</span><span class="o">.</span><span class="na">setClientMode</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>

        <span class="n">TcpDiscoveryVmIpFinder</span> <span class="n">finder</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TcpDiscoveryVmIpFinder</span><span class="o">();</span>
        <span class="n">finder</span><span class="o">.</span><span class="na">setAddresses</span><span class="o">(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">&quot;172.30.1.1&quot;</span><span class="o">));</span>

        <span class="n">TcpDiscoverySpi</span> <span class="n">discoverySpi</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TcpDiscoverySpi</span><span class="o">();</span>
        <span class="n">discoverySpi</span><span class="o">.</span><span class="na">setIpFinder</span><span class="o">(</span><span class="n">finder</span><span class="o">);</span>

        <span class="n">igniteCfg</span><span class="o">.</span><span class="na">setDiscoverySpi</span><span class="o">(</span><span class="n">discoverySpi</span><span class="o">);</span>
        <span class="n">serverConfig</span><span class="o">.</span><span class="na">putServiceObject</span><span class="o">(</span><span class="s">&quot;igniteConfiguration&quot;</span><span class="o">,</span> <span class="n">igniteCfg</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>
  If this configuration instance is passed in Ebean will use it to configure the Ignite instance.
  Otherwise it will use properties and avaje IgniteConfigBuilder.
</p>

<h3 id="getting-started">Getting started</h3>
<ul>
  <li>Annotate beans with @Cache</li>
  <li>Add maven dependency ebean-ignite</li>
  <li>Optionally add ebean-ignite-config.xml</li>
  <li>For client/server mode you need a running Ignite server</li>
</ul>




  </article>
</div>

</div>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="/js/site3.js"></script>
<script src="/js/search3.js"></script>
</body>
</html>
