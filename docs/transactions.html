
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta id="layout-head" />
    <title>Ebean ORM - Java/Kotlin/JVM</title>
    <link rel="shortcut icon" href="/images/favicon.ico" >
    <!--<link href="/css/bootstrap.min.css" rel="stylesheet">-->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/css/site.css">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
      <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
  <body>
  <div id="wrap">
    <div id="header">
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".mobile-nav">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/"><img src="/images/logo-black-3.png" width="32" style="display: inline;">Ebean ORM</a>
        </div>
        <div class="collapse navbar-collapse">
<ul class="nav navbar-nav pull-right">
  <li ><a href="/"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li class="active"><a href="/docs">Docs</a></li>
  <li ><a target="_blank" href="/apidocs">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li ><a target="_blank" href="https://github.com/ebean-orm/avaje-ebeanorm"> <i class="fa fa-github"></i> Github</a></li>
</ul>        </div>
        <div class="mobile-nav">
<ul class="nav navbar-nav pull-right">
  <li ><a href="/"><span class="glyphicon glyphicon-home"></span>  Home</a></li>
  <li ><a href="/videos">Videos</a></li>
  <li ><a href="/quickstart">Quick Start</a></li>
  <li ><a href="/support">Support</a></li>
  <li class="active"><a href="/docs">Docs</a></li>
  <li ><a target="_blank" href="/apidocs">ApiDocs</a></li>
  <li ><a href="/releases">Releases</a></li>
  <li ><a target="_blank" href="https://github.com/ebean-orm/avaje-ebeanorm"> <i class="fa fa-github"></i> Github</a></li>
</ul>        </div>
      </div>
    </div>

  </div>
  <div id="main" data-offset="60">
<div class="jumbotron mini">
  <div class="container">
    <h1><a href="/docs">Documentation</a> / <a href="/docs/transactions">Transactions</a>  </h1>
  </div>
</div>

<div class="container doc-index bs-docs-container">

  <div class="row">

    <div class="col-md-9" role="main">
      <div class="bs-docs-section">
<h1 id="transactions">Transactions</h1>


<p>Within a Transaction, you can also control JDBC batching (batch size, flushing), turn on/off
transaction logging, and turn on/off cascading of save and delete. ...(under construction)... how?</p>


<h2 id="implicit_transactions">Implicit</h2>
<h4>Transactions are created implicitly for you</h4>

<p>
When there is no current transaction you can still execute a query, save or delete a bean etc.
When this happens Ebean will create an implicit transaction and commit it (or rollback if there was a failure).
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// execute a query without an existing transaction...</span>
<span class="c1">// ... a &quot;implicit&quot; transaction will be created</span>
<span class="c1">// ... and be commited (or rolled back) for you</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span>
            <span class="n">Ebean</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">&quot;customer&quot;</span><span class="o">)</span>
                <span class="o">.</span><span class="na">where</span><span class="o">().</span><span class="na">eq</span><span class="o">(</span><span class="s">&quot;state&quot;</span><span class="o">,</span> <span class="n">UserState</span><span class="o">.</span><span class="na">ACTIVE</span><span class="o">)</span>
                <span class="o">.</span><span class="na">findList</span><span class="o">();</span>

<span class="c1">// execute a save without an existing transaction...</span>
<span class="c1">// ... will create an implicit transaction</span>
<span class="c1">// ... and be commited (or rolled back) for you</span>
<span class="n">Ebean</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</pre></div>
</div>

<p>
The following SLF4J logs show the transaction that was implicitly created for the query.
</p>
<div class="syntax java"><div class="highlight"><pre><span></span><span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.362</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">c</span><span class="o">.</span><span class="na field">a</span><span class="o">.</span><span class="na field">e</span><span class="o">.</span><span class="na field">server</span><span class="o">.</span><span class="na field">lib</span><span class="o">.</span><span class="na field">thread</span><span class="o">.</span><span class="na">ThreadPool</span> <span class="o">-</span> <span class="n">ThreadPool</span> <span class="n">grow</span> <span class="n">created</span> <span class="o">[</span><span class="n">Ebean</span><span class="o">-</span><span class="n">h2</span><span class="mf">.0</span><span class="o">]</span> <span class="n">size</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.369</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">TXN</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1002</span><span class="o">]</span> <span class="n">Begin</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.548</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">INFO</span>  <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">TXN</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1002</span><span class="o">]</span> <span class="n">Commit</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.551</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">TXN</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Begin</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.554</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">or_order_ship</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.555</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">or_order_ship</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.556</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_order_detail</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">o_order_detail</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_order</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">o_order</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">contact</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">contact</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_customer</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">o_customer</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.557</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_address</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.558</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Delete</span> <span class="n">table</span><span class="o">[</span><span class="n">o_address</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.563</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_country</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.563</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">DeleteSql</span> <span class="n">table</span><span class="o">[</span><span class="n">o_country</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.563</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">delete</span> <span class="n">from</span> <span class="n">o_product</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.564</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">DeleteSql</span> <span class="n">table</span><span class="o">[</span><span class="n">o_product</span><span class="o">]</span> <span class="n">rows</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="n">bind</span><span class="o">[</span><span class="kc">null</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.567</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">o_country</span> <span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="n">values</span> <span class="o">(?,?);</span> <span class="o">--</span><span class="n">bind</span><span class="o">(</span><span class="n">NZ</span><span class="o">,</span><span class="n">New</span> <span class="n">Zealand</span><span class="o">,)</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.568</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Inserted</span> <span class="o">[</span><span class="n">Country</span><span class="o">]</span> <span class="o">[</span><span class="n">NZ</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.568</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">o_country</span> <span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span> <span class="n">values</span> <span class="o">(?,?);</span> <span class="o">--</span><span class="n">bind</span><span class="o">(</span><span class="n">AU</span><span class="o">,</span><span class="n">Australia</span><span class="o">,)</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.568</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">DEBUG</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SUM</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">Inserted</span> <span class="o">[</span><span class="n">Country</span><span class="o">]</span> <span class="o">[</span><span class="n">AU</span><span class="o">]</span>
<span class="mi">16</span><span class="o">:</span><span class="mi">38</span><span class="o">:</span><span class="mf">26.570</span> <span class="o">[</span><span class="n">main</span><span class="o">]</span> <span class="n">TRACE</span> <span class="n">org</span><span class="o">.</span><span class="na field">avaje</span><span class="o">.</span><span class="na field">ebean</span><span class="o">.</span><span class="na">SQL</span> <span class="o">-</span> <span class="n">txn</span><span class="o">[</span><span class="mi">1003</span><span class="o">]</span> <span class="n">insert</span> <span class="n">into</span> <span class="nf">o_product</span> <span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">sku</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">cretime</span><span class="o">,</span> <span class="n">updtime</span><span class="o">)</span> <span class="n">values</span> <span class="o">(?,?,?,?,?);</span> <span class="o">--</span><span class="n">bind</span>
</pre></div>
</div>

<h2 id="programmatic_transactions">Programmatic</h2>
<h4>Using begin, commit etc in a try finally block</h4>
<p>
A traditional approach for demarcating transactions via a try finally block.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">ebeanServer</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>
<span class="n">ry</span> <span class="o">{</span>
 <span class="c1">// fetch some stuff...</span>
 <span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="n">ebeanServer</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span>
 <span class="o">...</span>

 <span class="c1">// save or delete stuff...</span>
 <span class="n">ebeanServer</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">customer</span><span class="o">);</span>
 <span class="o">...</span>

 <span class="c1">// commit the transaction</span>
 <span class="n">ebeanServer</span><span class="o">.</span><span class="na">commitTransaction</span><span class="o">();</span>

 <span class="k">finally</span> <span class="o">{</span>
 <span class="c1">// rollback the transaction if it was not committed</span>
 <span class="n">ebeanServer</span><span class="o">.</span><span class="na">endTransaction</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="tx_control_behaviour">Controlling behaviour in a transaction</h2>
<p>
You can use the Transaction to explicitly control behaviour.

<div class="syntax java"><div class="highlight"><pre><span></span><span class="n">Transaction</span> <span class="n">transaction</span> <span class="o">=</span> <span class="n">ebeanServer</span><span class="o">.</span><span class="na">beginTransaction</span><span class="o">();</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="c1">// turn of cascade persist</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">setCascadePersist</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

  <span class="c1">// control the jdbc batch mode and size</span>
  <span class="c1">// transaction.setBatchMode(true); // equivalent to transaction.setBatch(PersistBatch.ALL);</span>
  <span class="c1">// transaction.setBatchMode(false); // equivalent to transaction.setBatch(PersistBatch.NONE);</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">setBatch</span><span class="o">(</span><span class="n">PersistBatch</span><span class="o">.</span><span class="na">ALL</span><span class="o">);</span> <span class="c1">// PersistBatch: NONE, INSERT, ALL</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">setCascadeBatch</span><span class="o">(</span><span class="n">PersistBatch</span><span class="o">.</span><span class="na">INSERT</span><span class="o">);</span> <span class="c1">// PersistBatch: NONE, INSERT, ALL</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">setBatchSize</span><span class="o">(</span><span class="mi">30</span><span class="o">);</span>


  <span class="c1">// for a large batch insert if you want to skip</span>
  <span class="c1">// getting the generated keys</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">setBatchGetGeneratedKeys</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>

  <span class="c1">// for batch processing via raw SQL you can inform</span>
  <span class="c1">// Ebean what tables were modified so that it can</span>
  <span class="c1">// clear the appropriate L2 caches</span>
  <span class="n">String</span> <span class="n">tableName</span> <span class="o">=</span> <span class="s">&quot;o_customer&quot;</span><span class="o">;</span>
  <span class="kt">boolean</span> <span class="n">inserts</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="kt">boolean</span> <span class="n">upates</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="kt">boolean</span> <span class="n">deletes</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">addModification</span><span class="o">(</span><span class="n">tableName</span><span class="o">,</span> <span class="n">inserts</span><span class="o">,</span> <span class="n">updates</span><span class="o">,</span> <span class="n">deletes</span><span class="o">);</span>

  <span class="o">...</span>
<span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
  <span class="n">transaction</span><span class="o">.</span><span class="na">end</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
</p>

<h2 id="transactional">@Transactional</h2>
<p>
You must be using <em>ENHANCEMENT</em> for @Transactional to work. That means you
must be enhancing the classes via IDE Plugin, Ant Task or javaagent. Refer to the
user guide for more details on enhancement.
</p>

<p>
Ebean can enhance your pojos to add transactional support. To do so put the
@Transaction annotation on a method or class. Ebean enhancement will then add
the supporting transactional logic (begin transaction, commit, rollback, suspend and resuming transactions etc).
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="c1">// any old pojo</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyService</span> <span class="o">{</span>

	<span class="nd">@Transactional</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">runFirst</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>

		<span class="c1">// run in a Transaction (REQUIRED is the default)</span>

		<span class="c1">// find a customer</span>
		<span class="n">Customer</span> <span class="n">customer</span> <span class="o">=</span> <span class="n">Ebean</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">Customer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>

		<span class="c1">// call another &quot;transactional&quot; method</span>
		<span class="n">runInTrans</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="nd">@Transactional</span><span class="o">(</span><span class="n">type</span><span class="o">=</span><span class="n">TxType</span><span class="o">.</span><span class="na">REQUIRES_NEW</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">runInTrans</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>

		<span class="c1">// run in its own NEW transaction</span>
		<span class="c1">// ... suspend an existing transaction if required</span>
		<span class="c1">// ... and resume it when this method ends</span>

		<span class="c1">// find new orders</span>
		<span class="n">List</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">Order</span><span class="o">&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">Ebean</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">Order</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
									<span class="o">.</span><span class="na">where</span><span class="o">().</span><span class="na">eq</span><span class="o">(</span><span class="s">&quot;status&quot;</span><span class="o">,</span><span class="n">OrderStatus</span><span class="o">.</span><span class="na">NEW</span><span class="o">)</span>
									<span class="o">.</span><span class="na">findList</span><span class="o">();</span>
		<span class="o">...</span>
</pre></div>
</div>

<p>
Put the @Transactional annotation on you methods and Ebean
can enhance the classes adding the Transactional management.
</p>

<h4 class="plain">Standard transaction scope types</h4>
<p>
This supports the standard propagation rules of
REQUIRED (the default), REQUIRES_NEW, MANDATORY, SUPPORTS, NOT_SUPPORTS, NEVER.
These are an exact match of the EJB TransactionAttributeTypes.
</p>

<h4 class="plain">Nested Transactions</h4>
<p>
Transactional methods can be nested as in the above example where
runFirst() calls runInTrans().
</p>

<h4 class="plain">Isolation level and specific exception support</h4>
<p>
@Transactional (like Spring) supports isolation levels and explicit
handling of Exceptions (to rollback or not for specific exceptions).
Please refer to the User Guide for a more detailed explanation.
</p>

<h4 class="plain">Interfaces</h4>
<p>
You can put @Transactional on interfaces and classes that
implement those interfaces will get the transactional enhancement.
</p>


<h2 id="tx_runnable">TxRunnable / TxCallable</h2>
<p>
TxRunnable and TxCallable are the programmatic equivalent to @Transactional.
</p>
<p>
You can mix @Transaction with TxRunnable and TxCallable if you like, they
will behave correctly together.
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">myMethod</span><span class="o">()</span> <span class="o">{</span>
  <span class="o">...</span>
  <span class="n">System</span><span class="o">.</span><span class="na field">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot; Some code in myMethod...&quot;</span><span class="o">);</span>

  <span class="c1">// run in Transactional scope...</span>
  <span class="n">Ebean</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="n">TxRunnable</span><span class="o">()</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>

		<span class="c1">// code running in &quot;REQUIRED&quot; transactional scope</span>
		<span class="c1">// ... as &quot;REQUIRED&quot; is the default TxType</span>
		<span class="n">System</span><span class="o">.</span><span class="na field">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Ebean</span><span class="o">.</span><span class="na">currentTransaction</span><span class="o">());</span>

		<span class="c1">// find stuff...</span>
		<span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">Ebean</span><span class="o">.</span><span class="na">find</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
		<span class="o">...</span>

		<span class="c1">// save and delete stuff...</span>
		<span class="n">Ebean</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
		<span class="n">Ebean</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">order</span><span class="o">);</span>
		<span class="o">...</span>
	<span class="o">}</span>
  <span class="o">});</span>

  <span class="n">System</span><span class="o">.</span><span class="na field">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot; more code in myMethod...&quot;</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>
Generally you will use TxRunnable like the above as anonymous inner classes.
</p>
<p>
The code inside the run() will execute inside a transactional scope with Ebean
handling the transaction propagation for you (just like @Transactional).
</p>

<div class="syntax java"><div class="highlight"><pre><span></span><span class="c1">// programmatic control over the scope such as</span>
<span class="c1">// ... isolation level</span>
<span class="c1">// ... and to rollback or not for specific exceptions</span>

<span class="n">TxScope</span> <span class="n">txScope</span> <span class="o">=</span> <span class="n">TxScope</span>
			<span class="o">.</span><span class="na">requiresNew</span><span class="o">()</span>
			<span class="o">.</span><span class="na">setIsolation</span><span class="o">(</span><span class="n">TxIsolation</span><span class="o">.</span><span class="na">SERIALIZABLE</span><span class="o">)</span>
			<span class="o">.</span><span class="na">setNoRollbackFor</span><span class="o">(</span><span class="n">IOException</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="n">Ebean</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">txScope</span><span class="o">,</span> <span class="k">new</span> <span class="n">TxRunnable</span><span class="o">()</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
		<span class="o">...</span>
<span class="o">}</span>
</pre></div>
</div>

<h2 id="Spring">Spring</h2>
(under construction)

<h2 id="jta">JTA</h2>
(under construction)

</div>
    </div>

    <div class="col-md-3" role="complementary">
      <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">
        <ul class="nav bs-docs-sidenav">
<li class="active">
  <a href="/docs/transactions">Transactions</a>
<ul class="nav">
  <li><a href="#implicit_transactions">Implicit</a></li>
  <li><a href="#programmatic_transactions">Programmatic</a></li>
  <li><a href="#tx_control_behaviour">Controlling behaviour in a transaction</a></li>
  <li><a href="#transactional">@Transactional</a></li>
  <li><a href="#tx_runnable">TxRunnable / TxCallable</a></li>
  <li><a href="#spring">Spring</a></li>
  <li><a href="#jta">JTA</a></li>
</ul>
</li>
        </ul>
      </nav>
    </div>
  </div>

</div>
<!-- /.row -->
</div>  <!-- /.container -->
  </div>
  </div>

<footer id="footer">
  <div class="doc-footer">
    <ul class="doc-footer-links">
      <li><a href="/">Ebean ORM</a></li>
      <li> | </li>
      <li><a href="http://avaje-metric.github.io">Metrics</a></li>
    </ul>
  </div>
</footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/jquery.easing.min.js"></script>

    <script src="/js/json2.js"></script>
  <script src="/js/jquery.cookie.min.js"></script>
  <script src="/js/jquery.storageapi.min.js"></script>

  <script src="/js/ebean-site.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75181644-1', 'auto');
    ga('send', 'pageview');

  </script>  </body>
</html>
